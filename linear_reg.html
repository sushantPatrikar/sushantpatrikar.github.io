<!DOCTYPE html>
<html>
<head>
	<title>Linear Regression Simulator</title>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/"
    <link href="https://fonts.googleapis.com/css?family=Lato:700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Encode+Sans+Expanded&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Work+Sans:400,500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+HK&display=swap" rel="stylesheet">

    <style type="text/css">
    	.bg-dark{
    		background-color: #2b28288a!important;
    	}
    	.navbar-dark .navbar-nav .nav-link {
		    color: white;
		    font-family: 'Rubik', sans-serif;
		    font-size: 1.2em;

		}
		.heading{
			font-family: 'Work Sans', sans-serif;
			padding-top: 5%
		}
		.para{
			font-family: 'Noto Sans HK', sans-serif;
			padding-top: 0.7%

		}
    </style>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-142114907-1"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-142114907-1');
	</script>
</head>
<body>
		<!-- NavBar -->
	<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
	  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
	    <span class="navbar-toggler-icon"></span>
	  </button>

		<div class="collapse navbar-collapse" id="navbarSupportedContent">
		    <ul class="navbar-nav ml-auto">
		    	<li class="nav-item">
					<a class="nav-link" href="index.html#home">Home<span class="sr-only">(current)</span></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="index.html#aboutme">About Me</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="index.html#projects">Projects</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="index.html#contact">Contact</a>
				</li>
		    </ul>
		</div>
	</nav>

	<div class="container" style="padding-top: 15%; text-align: center; font-family: 'Muli', sans-serif; ">
		<h1 style="font-weight: 1000">
			Linear Regression Simulator
		</h1>

		<h3 style="padding-top: 4%">Read this article on <a href="https://towardsdatascience.com/everything-you-need-to-know-about-linear-regression-b791e8f4bd7a">Medium</a></h3>

		<img src="img/sim.gif" class="img-fluid float-none" style="padding-top: 5%">

		<h4 style="padding-top: 2%; font-family: 'Roboto Condensed', sans-serif;">
			In these article we will look into all the maths behind the linear regression.
		</h4>
	</div>

	<div class="container">
		<p class="para">Linear Regression is the first stepping stone in the field of Machine Learning. If you are new in Machine Learning or a math geek and want to know all the math behind Linear Regression, then you are at the same spot as I was 9 months ago. Here we will look at the math of linear regression and understand the mechanism behind it.</p>

		<h2 class="heading">
			Introduction
		</h2>

		<p class="para">
			Linear Regression. After breaking it down, we get two words ‘Linear’ & ‘Regression’. When we think mathematically, the word ‘Linear’ appears to be something related to the straight line while the term ‘Regression’ means A technique for determining the statistical relationship between two or more variables.
		</p>

		<p class="para">
			Simply putting it together, Linear Regression is all about finding an equation of a line that almost fits the given data so that it can predict the future values.
		</p>

		<h2 class="heading">
			Hypothesis
		</h2>

		<p class="para">
			Now, what’s this hypothesis? It’s nothing but the equation of line we were talking about. Let’s look at the equation below.
		</p>

		<p class="para"style="text-align: center;">
			<img class= "img-fluid float-none" class="img-fluid float-none" src="img/y.png">
		</p>

		<p class="para">
			Does this look familiar to you? It is the equation of a straight line. This is a hypothesis. Let’s rewrite this in a somewhat similar way.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/h.png">
		</p>

		<p class="para">
			We have just replaced y with h(x) and c,m with Θ₀ and Θ₁ respectively. h(x) will be our predicted value. This is the most common way of writing a hypothesis in Machine Learning.
		</p>

		<p class="para">
			Now to understand this hypothesis, we will take the example of the housing prices. Suppose you collect the size of different houses in your locality and their respective prices. The hypothesis can be represented as
		</p>

		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/home.png">
		</p>

		<p class="para">
			Now all you have to do is find the appropriate base price and the value of Θ₁ based on your dataset so that you can predict the price of any house when given its size.
		</p>
		<p class="para">
			To say it more technically, we have to tune the values of Θ₀ & Θ₁ in such a way that our line fits the dataset in the best way possible. Now we need some metric to determine the ‘best’ line, and we have it. It’s called a cost function. Let’s look into it.
		</p>

		<h2 class="heading">
			Cost Function J(Θ)
		</h2>

		<p class="para">
			The cost function of the linear regression is
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/cost.png">
		</p>
		<p class="para">
			To make it look more beautiful for our brain, we can rewrite it as
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/cost_sim.png">
		</p>
		<p class="para">
			Here m means the total number of examples in your dataset. In our example, m will be the total number of houses in our dataset.
		</p>
		<p class="para">
			Now look at our cost function carefully, we need predicted values i.e h(x) for all m examples. Let’s look again how our predicted values or predicted price look like.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/home.png">
		</p>
		<p class="para">
			To calculate our cost function, what we need is h(x) for all m examples i.e m predicted prices corresponding to m houses.
		</p>
		<p class="para">
			Now, to calculate h(x), we need a base price and the value of Θ₁. Note that these are the values which we will tune to find our best fit. We need something to start with, so we will randomly initialize these two values.
		</p>

		<h2 class="heading">
			Explanation of Cost Function
		</h2>
		<p class="para">
			If you look at the cost function carefully
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/cost_sim.png">
		</p>
		<p class="para">
			you’ll find that what we are doing is just averaging the square of the distances between predicted values and actual values over all the m examples.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/graph.png">
		</p>
		<p class="para">
			Look at the graph above, here m = 4. The points on the blue line are predicted values while the red points are actual values. The green line is the distance between the actual value and the predicted value.
		</p>
		<p class="para">
			The cost for this line will be
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/cost_solve.png">
		</p>
		<p class="para">
			So what the cost function calculates is just the mean of the square of the length of green lines. We also divide it by 2 to ease out some future calculations which we will see.
		</p>
		<p class="para">
			Linear Regression tries to minimize this cost by finding the proper values of Θ₀ and Θ₁. How? By using Gradient Descent.
		</p>
		<h2 class="heading">
			Gradient Descent
		</h2>
		<p class="para">
			Gradient Descent is a very important algorithm when it comes to Machine Learning. Right from Linear Regression to Neural Networks, it is used everywhere.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/grad_0.png">
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/grad_1.png">
		</p>
		<p class="para">
			This is how we update our weights. This update rule is executed in a loop & it helps us to reach the minimum of the cost function. The α is a constant learning rate which we will talk about in a minute.
		</p>
		<h2 class="heading">
			Understanding Gradient Descent
		</h2>
		<p class="para">
			So basically we are updating our weight by subtracting it with the partial derivative of our cost function w.r.t the weight.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/grad_weight.png">
		</p>
		<p class="para">
			But how is this taking us to the minimum cost? Let’s visualize it. For easy understanding, let’s assume that Θ₀ is 0 for now.
		</p>
		<p class="para">
			So the hypothesis becomes
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/theta1_hypo.png">
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			And the cost function
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/theta1_cost.png">
		</p>
		<p class="para">
			Now let’s see how the cost is dependent on the value of Θ₁. Since this is a quadratic equation, the graph of Θ₁ vs J(Θ) will be a parabola and it will look something like this with Θ₁ on the x-axis and J(Θ) on the y-axis.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/gradgraph_0.png">
		</p>
		<p class="para">
			Our goal is to reach the minimum of the cost function, which we will get when our Θ₁ will be equal to Θₘᵢₙ.
		</p>
		<p class="para">
			Now, to start with we will randomly initialize our Θ₁.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/gradgraph_1.png">
		</p>
		<p class="para">
			Suppose, the Θ₁ gets initialized as shown in the figure. The cost corresponding to current Θ₁ is equal to the blue dot on the graph.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/grad_1.png">
		</p>
		<p class="para">
			We are subtracting the derivative of the cost function w.r.t Θ₁ multiplied by some constant.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/gradgraph_2.png">
		</p>
		<p class="para">
			The derivative of cost function w.r.t Θ₁ gives the slope of the curve at that point. Which in these case is positive. So we are subtracting positive quantity from our current value of Θ₁. This will force Θ₁ to move in the left direction and slowly diverge to the value of Θₘᵢₙ where our cost function is minimum. Here comes the role of α which is our learning rate. It is the learning rate which decides how much we want to descent in one iteration. Also, one point to note here is that as we are moving to the minimum, the slope of the curve is also getting less steeper that means, as we are reaching the minimum value, we will be taking smaller and smaller steps.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/gradgraph_3.png">
		</p>
		<p class="para">
			Eventually, the slope will become zero at the minimum of the curve and then Θ₁ will not be updated.
		</p>
		<p class="para">
			Think of it like this. Suppose a man is at top of the valley and he wants to get to the bottom of the valley. So he goes down the slope taking larger steps when the slope is steep and smaller steps when the slope is less steep. He decides his next position based on his current position and stops when he gets to the bottom of the valley which was his goal.
		</p>
		<p class="para">
			Similarly, if the Θ₁ is initialized on the left side of the minimum value,
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/gradgraph_4.png">
		</p>
		<p class="para">
			The slope at this point will be negative. In gradient descent, we subtract the slope, but here slope is negative. So, the negative of negative will become positive. So we will keep on adding until it is reached where cost becomes minimum.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/gradient_descent.jpg">
		</p>
		<p class="para">
			The above figure is a good depiction of gradient descent. Note how the steps are getting smaller and smaller as we are reaching the minimum.
		</p>
		<p class="para">
			Similarly, the value of Θ₀ will also be updated using gradient descent. I did not show it, because we need to update the values of Θ₀ and Θ₁ simultaneously which will result in a 3-dimensional graph (cost on one axis, Θ₀ on one axis and Θ₁ on another axis) which becomes kind of hard to visualize.
		</p>
		<h2 class="heading">
			Derivative of Cost Function
		</h2>
		<p class="para">
			We are using a derivative of the cost function in gradient descent.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/grad_0.png">
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/grad_1.png">
		</p>
		<p class="para">
			Let’s look at what we get after differentiating it.
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/graddiff_0.png">
		</p>
		<p class="para">
			Similarly, for Θ₁
		</p>
		<p class="para img-fluid float-none" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/graddiff_1.png">
		</p>
		<h2 class="heading">
			Linear Regression Visualization
		</h2>
		<p class="para" style="text-align: center;">
			<img class= "img-fluid float-none" src="img/sim.gif">
		</p>
		<p class="para">
			In this visualization, you can see how the line is fitting to the dataset. Note that initially, the line is covering the distance very quickly. But as the cost is decreasing, the line becomes slower.
		</p>
		<p class="para">
			The code for the above visualization is available on my <a href="https://github.com/sushantPatrikar/Linear-Regression-Simulator">GitHub</a>.
		</p>

	</div>

</body>
</html>